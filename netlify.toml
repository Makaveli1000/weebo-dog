# netlify.toml

[build]
  # CRITICAL FIX: Create a 'dist' directory first.
  # Then run the config script to place env-config.js into 'dist'.
  # Then copy all other static assets (index.html, app.module.js) into 'dist'.
  command = "mkdir -p dist && chmod +x create-config.sh && ./create-config.sh && cp index.html dist/index.html && cp app.module.js dist/app.module.js"
  
  # CRITICAL FIX: Publish from the newly created 'dist' directory.
  publish = "dist" 

[[redirects]]
  # This rule ensures that all routes (e.g., /account, /dashboard) are 
  # served by index.html, which is essential for a Single Page Application (SPA).
  from = "/*"
  to = "/index.html"
  status = 200
